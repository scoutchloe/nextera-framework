spring:
  application:
    name: nextera-id-test
  
  # 测试Redis配置 - 使用embedded-redis
  data:
    redis:
      host: localhost
      port: 6380  # 测试端口
      password: 
      database: 1  # 测试数据库
      timeout: 5000
      lettuce:
        pool:
          max-active: 8
          max-wait: -1
          max-idle: 8
          min-idle: 0
  
  # 测试PostgreSQL配置 - 使用H2内存数据库
  datasource:
    url: jdbc:h2:mem:testdb;DB_CLOSE_DELAY=-1;MODE=PostgreSQL
    username: sa
    password: 
    driver-class-name: org.h2.Driver
    hikari:
      minimum-idle: 1
      maximum-pool-size: 5
      idle-timeout: 300000
      connection-timeout: 20000
      max-lifetime: 1200000

# MyBatis Plus配置
mybatis-plus:
  configuration:
    map-underscore-to-camel-case: true
    log-impl: org.apache.ibatis.logging.slf4j.Slf4jImpl
  global-config:
    db-config:
      logic-delete-field: deleted
      logic-delete-value: 1
      logic-not-delete-value: 0

# Nextera ID测试配置
nextera:
  id:
    default-strategy: REDIS
    redis:
      host: localhost
      port: 6380
      password: 
      database: 1
      batch-size: 10  # 测试用小批量
      expire-time: 60
    postgresql:
      url: jdbc:h2:mem:testdb
      username: sa
      password: 
      batch-size: 20
    business-types:
      test-user: 
        strategy: REDIS
        batch-size: 10
        start-value: 1
      test-order:
        strategy: POSTGRESQL
        batch-size: 20
        start-value: 1001
      test-article:
        strategy: REDIS
        batch-size: 5
        start-value: 1

# Dubbo配置 - 测试环境禁用注册中心
dubbo:
  application:
    name: nextera-id-test
    qos-enable: false
  registry:
    address: N/A  # 禁用注册中心
  protocol:
    name: dubbo
    port: -1  # 随机端口
  provider:
    timeout: 5000

# 日志配置
logging:
  level:
    com.nextera.id: DEBUG
    org.springframework.data.redis: DEBUG
    org.springframework.jdbc: DEBUG
    org.mybatis: DEBUG
  pattern:
    console: '%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level %logger{50} - %msg%n' 